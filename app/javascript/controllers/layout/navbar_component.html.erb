<header class="h-[60px] bg-[#0066b3] flex items-center justify-between shadow-md z-30 relative shrink-0" 
        data-controller="layout--navbar-component" 
        data-action="click@window->layout--navbar-component#hideDropdown">
  
  <%# 左侧 Logo 区域 - 宽度与 Sidebar 对齐 %>
  <div class="w-64 h-full flex items-center px-6 shrink-0 border-none">
    <a class="hover:opacity-80 transition-opacity" href="/">
      <%# 确保 logo.svg 存在于 assets 目录 %>
      <%= image_tag asset_path('logo.svg'), class: 'w-auto max-h-[36px] block', alt: 'Logo' %>
    </a>
  </div>

  <%# 中间主导航区域 %>
  <div class="flex-1 flex h-full justify-center">
    <nav class="flex h-full items-center">
      <% @nav_items.each do |item| %>
        <%# 核心：调用组件类中的 is_active? 逻辑判断选中状态 %>
        <% active = is_active?(item) %>
        
        <a data-action="click->layout--navbar-component#handleItemClick" href="<%= item[:path] %>" 
           class="group relative px-8 h-full flex flex-col items-center justify-center transition-all duration-200
                  <%= active ? 'bg-white/15 text-white' : 'text-white/60 hover:bg-white/10 hover:text-white' %>">
          
          <%# 图标：variant: :solid 配合 group-hover 缩放 %>
          <%= heroicon item[:icon], variant: :solid, options: { 
              class: "h-6 w-6 mb-0.5 transition-transform group-hover:scale-110" 
          } %>

          <span class="text-sm font-bold tracking-wider leading-none"><%= item[:label] %></span>

          <%# 选中状态底部的装饰条 - 橙色 4px 高度 %>
          <% if active %>
            <div class="absolute bottom-0 left-0 w-full h-[4px] bg-orange-400 animate-in fade-in duration-300"></div>
          <% end %>
        </a>
      <% end %>
    </nav>
  </div>

  <%# 右侧工具栏与用户信息 %>
  <div class="w-64 h-full flex items-center justify-end px-6 space-x-5">
    <%# 消息通知按钮 %>
    <button class="relative p-1.5 text-white/70 hover:text-white hover:bg-white/10 rounded-full transition-all group">
      <%= heroicon "bell", variant: :solid, options: { class: "h-6 w-6" } %>
      <span class="absolute top-1 right-1 flex h-4 w-4 items-center justify-center rounded-full bg-red-500 text-[10px] font-bold text-white ring-2 ring-[#0066b3]">
        3
      </span>
    </button>

    <%# 用户下拉菜单按钮 %>
    <div class="relative">
      <button data-action="click->layout--navbar-component#toggleDropdown" 
              class="flex items-center space-x-3 group focus:outline-none py-1 px-1 rounded-lg hover:bg-white/5 transition-all">
        <div class="flex flex-col items-end leading-tight">
          <span class="text-[10px] text-orange-200 font-bold uppercase tracking-tighter opacity-80"><%= @role %></span>
          <span class="text-[14px] font-bold text-white"><%= @user_name %></span>
        </div>
        <div class="w-9 h-9 bg-white/10 rounded-full flex items-center justify-center shrink-0 border border-white/20 group-hover:border-white/40 transition-all overflow-hidden">
          <%= heroicon "user", variant: :solid, options: { class: "h-5 w-5 text-white/90" } %>
        </div>
      </button>

      <%# 下拉菜单内容区 %>
      <div data-layout--navbar-component-target="dropdown" 
           class="hidden absolute right-0 mt-2 w-44 bg-white rounded shadow-2xl py-1 text-slate-700 ring-1 ring-black/10 z-50 overflow-hidden">
        
        <a class="block px-4 py-2.5 text-sm hover:bg-slate-50 flex items-center transition-colors" href="#">
          <%= heroicon "user-circle", variant: :solid, options: { class: "h-5 w-5 mr-3 text-slate-400" } %>
          个人中心
        </a>
        
        <div class="h-px bg-slate-100 my-1 mx-2"></div>
        
        <a 
          data-turbo-method="delete" 
          data-action="click->layout--navbar-component#logout"
          class="block px-4 py-2.5 text-sm text-red-500 hover:bg-red-50 flex items-center transition-colors" href="/users/sign_out">
          <%= heroicon "arrow-right-on-rectangle", variant: :solid, options: { class: "h-5 w-5 mr-3 text-red-400" } %>
          退出登录
        </a>
      </div>
    </div>
  </div>
</header>

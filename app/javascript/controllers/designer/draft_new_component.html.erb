<%# app/components/designer/draft_new_component.html.erb %>
<div class="w-full flex justify-center py-12" data-controller="designer--draft-new-component">
  <div class="w-full max-w-md bg-white border border-slate-200 rounded-2xl shadow-sm overflow-hidden">
    
    <div class="px-6 py-4 border-b border-slate-100 flex items-center justify-between">
      <div class="flex items-center gap-2.5">
        <div class="w-1.5 h-5 bg-[#0066b3] rounded-full"></div>
        <h3 class="text-sm font-bold text-slate-800 tracking-tight">上传新稿件</h3>
      </div>
    </div>

    <%= form_with model: @draft, url: helpers.designer_drafts_path, id: "draft-form", class: "p-6" do |f| %>
      
      <%# --- Flash 消息区域 (参考登录页样式) --- %>
      <div id="flash-messages" class="mb-4 space-y-2">
        <% if helpers.alert.present? %>
          <p class="text-[10px] text-red-500 text-center bg-red-50 py-1 rounded"><%= helpers.alert %></p>
        <% end %>
        <% if helpers.notice.present? %>
          <p class="text-[10px] text-green-600 text-center bg-green-50 py-1 rounded"><%= helpers.notice %></p>
        <% end %>
      </div>

      <div class="space-y-4">
        <div class="relative group">
          <div class="border-2 border-dashed border-slate-200 rounded-xl p-8 transition-all duration-300 
                      hover:border-[#0066b3]/50 hover:bg-slate-50 flex flex-col items-center justify-center gap-3 cursor-pointer">
            <div class="text-[#0066b3]/30 group-hover:text-[#0066b3] transition-colors">
              <%= heroicon "document-arrow-up", variant: :outline, options: { class: "h-10 w-10" } %>
            </div>
            <div class="text-center">
              <span class="text-xs font-bold text-slate-600 block">点击或拖拽文件上传</span>
              <span class="text-[10px] text-slate-400 mt-1 block uppercase tracking-tighter">PDF, PNG or JPG (Max 50MB)</span>
            </div>
            <%= f.file_field :file, class: "absolute inset-0 w-full h-full opacity-0 cursor-pointer", id: "file-input",
                  data: { designer__draft_new_component_target: "input", action: "change->designer--draft-new-component#handleFileChange" } %>
          </div>

          <div id="file-preview" data-designer--draft-new-component-target="preview" 
               class="hidden relative z-20 mt-4 p-3 bg-slate-50 border border-slate-200 rounded-xl flex items-center justify-between">
            <div class="flex items-center gap-2.5 truncate">
              <div class="text-[#0066b3]"><%= heroicon "paper-clip", variant: :mini, options: { class: "h-4 w-4" } %></div>
              <span id="file-name" data-designer--draft-new-component-target="fileName" class="text-[11px] font-bold text-slate-700 truncate max-w-[160px]"></span>
            </div>
            <button type="button" data-action="click->designer--draft-new-component#removeFile" class="text-[10px] font-bold text-red-500 hover:text-red-700 cursor-pointer">移除</button>
          </div>
        </div>

        <div class="pt-4">
          <%= f.submit "确认上传", class: "w-full py-2.5 bg-[#0066b3] text-white text-xs font-bold rounded-lg shadow-sm hover:bg-[#005596] active:scale-[0.98] transition-all cursor-pointer" %>
          <div class="text-center mt-3">
            <%= link_to "返回列表", helpers.designer_drafts_path, class: "text-[11px] font-bold text-slate-400 hover:text-slate-600 transition", data: { turbo: false } %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>